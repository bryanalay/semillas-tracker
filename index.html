<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Semillas</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        form { max-width: 400px; margin: auto; }
        label { display: block; margin-top: 10px; }
        .toggle-group { margin-bottom: 10px; }
        .date-display { background-color: #f0f0f0; padding: 5px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>Formulario de Registro de Semillas</h1>
    <form action="/submit" method="post" enctype="multipart/form-data">
        <div class="toggle-group">
            <label for="nombre">Selecciona un nombre:</label>
            <select id="nombre" name="nombre" required>
                <option value="carlos">Bryan Alay</option>
                <option value="paco">Paco</option>
            </select>
        </div>

        <div class="toggle-group">
            <label for="entorno">Entorno:</label>
            <select id="entorno" name="entorno" required>
                <option value="production">Production</option>
                <option value="test">Test</option>
            </select>
        </div>

        <div class="toggle-group">
            <label for="semilla">Tipo de semilla:</label>
            <select id="semilla" name="semilla" required>
                <option value="guanabana">Semilla de guanabana</option>
                <option value="frutilla">Semilla de frutilla</option>
            </select>
        </div>

        <label>Fecha actual:</label>
        <div id="fecha-actual" class="date-display"></div>
        <input type="hidden" name="fecha" id="fecha-hidden">

        <label for="imagen">Subir imagen:</label>
        <input type="file" id="imagen" name="imagen" accept="image/*" required>

        <br><br>
        <button type="submit">Enviar</button>
    </form>

    <script>
        // Mostrar la fecha actual en la zona horaria del usuario
        const fechaDiv = document.getElementById('fecha-actual');
        const ahora = new Date();
        const fechaString = ahora.toLocaleString('es-ES', {
            timeZone: 'America/Guayaquil',
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit'
        });
        fechaDiv.textContent = fechaString;
        document.getElementById('fecha-hidden').value = fechaString;

        // Manejar el envío del formulario
        const form = document.querySelector('form');
        form.addEventListener('submit', function(event) {
            event.preventDefault(); // Prevenir el envío por defecto

            if (!form.checkValidity()) {
                alert('Por favor, completa todos los campos obligatorios.');
                return;
            }

            const formData = new FormData(form);

            fetch('http://localhost:5678/webhook/abc43991-bf58-44c6-b8bc-5689204fe4ee', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    alert('Formulario enviado exitosamente.');
                    form.reset(); // Limpiar el formulario
                } else {
                    alert('Error al enviar el formulario.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error de conexión.');
            });
        });
    </script>
</body>
</html>
